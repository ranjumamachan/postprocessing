# IVmetareading.py

## Description

This script automates the process of extracting and summarizing key metadata from IV (Current-Voltage) curve CSV files, typically generated by measurement equipment for photovoltaic or similar devices. It processes the file(s) provided by the user, extracts important parameters for each sample (such as open circuit voltage, voltage at maximum power, current at maximum power, and maximum power), and creates a summary Excel file with four organized sheets for easy review and further data analysis.

## How It Works

1. **User Prompt for File Path:**  
   The script prompts the user to enter the full path of a CSV file containing IV curve data. It validates that the file exists.

2. **File Parsing:**  
   The script reads the file and identifies each sampleâ€™s metadata by detecting lines starting with `"Sample No."`. For each sample, it extracts:
   - Sample Number
   - Date & Time
   - Vopen (Open Circuit Voltage)
   - Vmaxp (Voltage at Maximum Power)
   - Imaxp (Current at Maximum Power)
   - Pmax (Maximum Power)
   - ...and any other metadata present.

3. **Excel Summary Generation:**  
   The script creates an Excel file (`iv_curve_summary.xlsx`) in the same directory as the input file, with four separate sheets:
   - **Vopen**: Open Circuit Voltage for each sample
   - **Vmax**: Voltage at Maximum Power for each sample
   - **Imax**: Current at Maximum Power for each sample
   - **Pmax**: Maximum Power for each sample

   Each sheet contains:
   - Sample No.
   - Date & Time
   - The relevant measurement value

4. **Output & Reporting:**  
   The script displays:
   - Number of samples discovered
   - Sample count for each Excel sheet
   - The first few rows of the Vopen sheet
   - The output directory and file path
   - Success or error messages as appropriate

## Input

- **Required:**  
  A CSV file containing IV curve measurement data with metadata and measurement lines. The file must be accessible from the path you provide.

- **Format:**  
  The file should have sections per sample, each starting with a line containing `"Sample No."`, followed by metadata lines and (optionally) measurement data.

## Output

- **Excel file:**  
  `iv_curve_summary.xlsx`  
  Located in the same directory as the input file. Contains four sheets: Vopen, Vmax, Imax, Pmax, each with columns for Sample No., Date & Time, and the relevant measurement.

- **Console output:**  
  Informational messages about progress, results, and errors.

## Usage

1. Run the script:  
   `python IVmetareading.py`
2. When prompted, enter the full path to your CSV file (or drag and drop it into the terminal).
3. Review the progress and summary output in the console.
4. Find the Excel summary file in the same directory as your input file.

## Notes

- The script only extracts metadata, **not** the detailed IV data curves.
- Handles missing values and common byte order marks (BOM).
- Auto-adjusts column widths in the output Excel for readability.

---
**Author:** [ranjumamachan](https://github.com/ranjumamachan)  
**Repository:** [postprocessing](https://github.com/ranjumamachan/postprocessing)
